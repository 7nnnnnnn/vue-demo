import{_ as w,E as n,f as k,y as _,o as h,c as F,a as I,b as e,w as i,z as G,F as z,g as M,n as O,h as R,j as K,k as j,t as A,l as y,A as q,m as H,p as J,u as Q,s as W,B as X,q as Y}from"./index-74fb4b2e.js";/* empty css                        *//* empty css                 */import{a as g}from"./backend_api-b53d56ff.js";const Z={created(){this.GetAll()},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,l=t+this.pageSize;return this.filteredApiList.slice(t,l)},filteredApiList(){return this.searchText&&this.apiList?this.apiList.filter(t=>t.id==this.searchText):this.apiList}},data(){return{editedAPI:{},editDialogVisible:!1,currentPage:1,pageSize:6,searchText:"",apiList:[]}},methods:{handlePageChange(t){this.currentPage=t},clearSearch(){this.searchText=""},Cancel(){this.editDialogVisible=!1,n.info("保存取消！")},Getone(t){this.apiList=[],g.getOneData(t).then(l=>{console.log("搜索成功！"),n.success("搜索成功！");const p=l.data.backendApi;this.apiList.push(p)}).catch(l=>{n.error("搜索失败！"),console.log("搜索失败！")})},Save(){console.log("Saving API:",this.editedAPI);const t=this.apiList.findIndex(l=>l.id===this.editedAPI.id);t!==-1?this.apiList.splice(t,1,this.editedAPI):this.apiList.push(this.editedAPI),this.editDialogVisible=!1,n.success("保存成功！")},openEditDialog(t){this.editedAPI={...t},this.editDialogVisible=!0},editAPI(t){console.log("编辑 API",t)},deleteAPI(t){k.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{g.delData(t.id).then(l=>{if(l.success){const p=this.apiList.findIndex(b=>b.id===t.id);p!==-1&&this.apiList.splice(p,1),console.log("删除成功"),n.success("删除成功！")}else n.error(l.msg),console.error(l.msg)}).catch(l=>{console.error(l)}),console.log("删除 API")}).catch(l=>{console.log("不删除 API",l)})},deleteData(t){k.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=this.apiList.findIndex(p=>p.id===t.id);l!==-1&&this.apiList.splice(l,1),n.success("删除成功！")}).catch(()=>{n.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){n.success("添加数据ing");const t={apiMethod:"GET",apiName:"New API",apiSort:0,apiUrl:"/new-api",description:"这是新的API",hasChildren:!1,id:this.apiList.length+1,pid:0,isNew:!0};this.apiList.push(t)},async GetAll(){try{this.clearSearch();const t=await g.getAllData();if(t.success){const l=t.data.backendApis;this.apiList=l,n.success("刷新成功！")}else n.error("请求失败！"),console.error(t.msg)}catch(t){console.error(t)}},Insert(t){g.addData(t).then(l=>{delete t.isNew,n.success("添加成功！"),console.log("添加成功！")}).catch(l=>{n.error("添加失败！"),console.log("添加失败！")})},Alter(t){g.editData(t).then(l=>{console.log("修改成功！"),n.success("修改成功！")}).catch(l=>{console.log("修改失败！"),n.error("修改失败！")})}}},$={class:"dialog-footer"};function ee(t,l,p,b,o,s){const E=_("Search"),r=q,d=M,m=O,c=H,C=_("Position"),x=_("EditPen"),V=_("Delete"),D=R,T=K,L=_("CirclePlusFilled"),v=_("RefreshRight"),u=J,f=Q,S=W,U=X,N=Y,B=j;return h(),F(z,null,[I("div",null,[e(m,{modelValue:o.searchText,"onUpdate:modelValue":l[1]||(l[1]=a=>o.searchText=a),placeholder:"请输入搜索关键字",clearable:"",onClear:s.clearSearch,onKeyup:G(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},{append:i(()=>[e(d,{circle:"",type:"danger",onClick:l[0]||(l[0]=a=>s.Getone(this.searchText))},{default:i(()=>[e(r,null,{default:i(()=>[e(E)]),_:1})]),_:1})]),_:1},8,["modelValue","onClear","onKeyup"])]),I("div",null,[e(D,{data:s.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},border:""},{default:i(()=>[e(c,{prop:"id",label:"ID"}),e(c,{prop:"pid",label:"父级ID"}),e(c,{prop:"apiName",label:"API名称"}),e(c,{prop:"apiUrl",label:"API地址"}),e(c,{prop:"description",label:"描述"}),e(c,{prop:"apiMethod",label:"请求方法"}),e(c,{prop:"hasChildren",label:"是否有子级"}),e(c,{label:"操作"},{default:i(({row:a})=>[a.isNew?(h(),A(d,{key:0,class:"custom-button",type:"success",circle:"",onClick:P=>s.Insert(a)},{default:i(()=>[e(r,null,{default:i(()=>[e(C)]),_:1})]),_:2},1032,["onClick"])):(h(),A(d,{key:1,class:"custom-button",type:"warning",circle:"",onClick:P=>s.Alter(a)},{default:i(()=>[e(r,null,{default:i(()=>[e(C)]),_:1})]),_:2},1032,["onClick"])),e(d,{type:"primary",circle:"",onClick:P=>s.openEditDialog(a)},{default:i(()=>[e(r,null,{default:i(()=>[e(x)]),_:1})]),_:2},1032,["onClick"]),a.isNew?(h(),A(d,{key:2,type:"danger",circle:"",onClick:P=>s.deleteData(a)},{default:i(()=>[e(r,null,{default:i(()=>[e(V)]),_:1})]),_:2},1032,["onClick"])):(h(),A(d,{key:3,type:"danger",circle:"",onClick:P=>s.deleteAPI(a)},{default:i(()=>[e(r,null,{default:i(()=>[e(V)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),e(T,{"current-page":o.currentPage,"page-size":o.pageSize,total:s.filteredApiList.length,onCurrentChange:s.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),e(d,{type:"primary",circle:"",onClick:s.addAPI,style:{"margin-top":"10px"}},{default:i(()=>[e(r,null,{default:i(()=>[e(L)]),_:1})]),_:1},8,["onClick"]),e(d,{type:"primary",circle:"",onClick:s.GetAll,style:{"margin-top":"10px"}},{default:i(()=>[e(r,null,{default:i(()=>[e(v)]),_:1})]),_:1},8,["onClick"]),e(B,{modelValue:o.editDialogVisible,"onUpdate:modelValue":l[9]||(l[9]=a=>o.editDialogVisible=a),title:"编辑内容",center:"",width:"50%"},{footer:i(()=>[I("span",$,[e(d,{onClick:s.Cancel},{default:i(()=>[y("取消")]),_:1},8,["onClick"]),e(d,{type:"primary",onClick:s.Save},{default:i(()=>[y(" 保存 ")]),_:1},8,["onClick"])])]),default:i(()=>[e(N,{model:o.editedAPI,"label-width":"100px"},{default:i(()=>[e(u,{label:"id"},{default:i(()=>[e(m,{modelValue:o.editedAPI.id,"onUpdate:modelValue":l[2]||(l[2]=a=>o.editedAPI.id=a),disabled:""},null,8,["modelValue"])]),_:1}),e(u,{label:"父级ID"},{default:i(()=>[e(m,{modelValue:o.editedAPI.pid,"onUpdate:modelValue":l[3]||(l[3]=a=>o.editedAPI.pid=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"请求方法"},{default:i(()=>[e(S,{modelValue:o.editedAPI.apiMethod,"onUpdate:modelValue":l[4]||(l[4]=a=>o.editedAPI.apiMethod=a)},{default:i(()=>[e(f,{label:"GET",value:"GET"}),e(f,{label:"POST",value:"POST"}),e(f,{label:"PUT",value:"PUT"}),e(f,{label:"DELETE",value:"DELETE"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"API名称"},{default:i(()=>[e(m,{modelValue:o.editedAPI.apiName,"onUpdate:modelValue":l[5]||(l[5]=a=>o.editedAPI.apiName=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"API地址"},{default:i(()=>[e(m,{modelValue:o.editedAPI.apiUrl,"onUpdate:modelValue":l[6]||(l[6]=a=>o.editedAPI.apiUrl=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"描述"},{default:i(()=>[e(m,{modelValue:o.editedAPI.description,"onUpdate:modelValue":l[7]||(l[7]=a=>o.editedAPI.description=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"是否有子级"},{default:i(()=>[e(U,{modelValue:o.editedAPI.hasChildren,"onUpdate:modelValue":l[8]||(l[8]=a=>o.editedAPI.hasChildren=a),"active-color":"#409EFF","inactive-color":"#C0CCDA"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])],64)}const oe=w(Z,[["render",ee]]);export{oe as default};
