import{_ as F,d as L,y as f,o as h,c as b,a as c,b as t,w as a,t as V,G as T,F as C,e as U,E as m,f as W,g as j,n as $,s as z,h as D,j as M,k as O,l as r,r as q,m as G,p as P,q as H,u as J}from"./index-1c8d0cbc.js";/* empty css                        *//* empty css                 */import{a as K,g as Q,b as R,s as X,c as Y,d as Z,e as x}from"./student-d2be19c8.js";const ee=L({props:{page:{type:Object,default:()=>({current:1,school:"泉州信息工程学院",size:15})}},data(){return{allinfo:[],all:[],dialogFormVisible:!1,formLabelWidth:"80px",search:"",total:0,selectedClass:"",classinfoList:[],allinfos:{classinfo:"",createTime:"",depart:"",id:"",major:"",school:"",studentName:"",studentNo:"",updateTime:"",userId:0}}},mounted(){this.getAllInfo(1),this.getAll(),this.getWant()},methods:{getWant(){K({colums:1,classinfo:"2020软件工程1班"}).then(l=>{console.log(l)}).catch(l=>{console.log(l)})},getAll(){Q().then(e=>{console.log(e);const l=e.data;this.all=l.students,this.classinfoList=Array.from(new Set(this.all.map(s=>s.classinfo))),console.log(this.classinfoList),this.filterBySelectedClass()}).catch(e=>{console.log(e)}),this.allinfo=this.filteredInfo},getAllInfo(e){R({current:e,school:"泉州信息工程学院",size:15}).then(s=>{console.log(s);const n=s.data.page;this.allinfo=n.records,this.page.total=n.total,console.log(this.page.size)}).catch(s=>{console.log(s)})},rein(){location.reload()},currentchange(e){this.getAllInfo(e),this.page.current=e},onInputNumber(){this.search=this.search.replace(/[^0-9]/g,"")},addStudent(){this.allinfos={classinfo:"",createTime:"",depart:"",id:"",major:"",school:"",studentName:"",studentNo:"",updateTime:"",userId:0},this.dialogFormVisible=!0},editStudent(e){console.log(e),this.dialogFormVisible=!0,this.allinfos=U(e)},save(){const e=this.allinfos;e.id==0?X(e).then(l=>{if(l.success)this.dialogFormVisible=!1,console.log(this.page.current),this.getAllInfo(this.page.current),m(l.msg);else return m(l.msg),!1}).catch(l=>{m("网络错误联系管理员")}):Y(e).then(l=>{if(l.success)this.dialogFormVisible=!1,this.getAllInfo(this.page.current),m(l.msg);else return m(l.msg),!1}).catch(l=>{m("网络错误联系管理员")})},deleteStudent(e){W.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log(e),Z({id:e}).then(s=>{if(s.success)this.getAllInfo(this.page.current);else return console.log(s.msg),!1}).catch(s=>{console.log(s)})}).catch(l=>{})},searchStudentByNo(e){this.search!==""&&this.search!==null&&this.searchStudentnoData(e)},searchStudentnoData(e){x({studentNo:e}).then(s=>{console.log(s.data);let n=s.data;this.allinfo=[],Array.isArray(n==null?void 0:n.student)&&(n.student=[n.student]),this.allinfo=this.allinfo.concat(n.student),this.allinfo.length==0&&(this.page.total=0),this.page.current=1,this.page.total=this.allinfo.length}).catch(s=>{console.log(s),m("未找到该学生"),this.resetting(),this.page.total=0,this.page.current=0,console.log(this.page.total)})},resetting(){this.search=""},filterBySelectedClass(){if(!this.selectedClass){this.filteredInfo=[];return}this.filteredInfo=this.all.filter(e=>e.classinfo===this.selectedClass)},watch:{selectedClass(e){this.filterBySelectedClass()}}}}),le={class:""},te={class:"allinfo"},oe={class:"dialog-footer"};function ae(e,l,s,n,se,ne){const w=f("refresh"),i=j,y=f("circle-plus"),u=$,k=f("search"),N=J,I=z,d=G,S=f("edit"),v=f("delete"),E=D,B=M,p=P,_=H,A=O;return h(),b(C,null,[c("div",null,[c("div",le,[t(i,{onClick:e.rein},{default:a(()=>[t(w,{style:{width:"1em",height:"1em","margin-right":"8px"}}),r("刷新 ")]),_:1},8,["onClick"]),t(i,{style:{float:"right","margin-left":"50px"},onClick:e.addStudent},{default:a(()=>[t(y,{style:{width:"1em",height:"1em","margin-right":"8px"}}),r("添加")]),_:1},8,["onClick"]),t(u,{modelValue:e.search,"onUpdate:modelValue":l[0]||(l[0]=o=>e.search=o),type:"text",placeholder:"输入学号搜索",style:{width:"500px","margin-left":"50px"},onInput:e.onInputNumber},null,8,["modelValue","onInput"]),t(i,{onClick:l[1]||(l[1]=o=>e.searchStudentByNo(e.search))},{default:a(()=>[t(k,{style:{width:"1em",height:"1em","margin-right":"8px"}}),r("搜索 ")]),_:1}),t(i,{onClick:e.resetting},{default:a(()=>[r("重置")]),_:1},8,["onClick"]),t(I,{modelValue:e.selectedClass,"onUpdate:modelValue":l[2]||(l[2]=o=>e.selectedClass=o),placeholder:"选择班级",style:{"margin-left":"8px"}},{default:a(()=>[(h(!0),b(C,null,q(e.classinfoList,(o,g)=>(h(),V(N,{key:g,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",te,[t(E,{data:e.allinfo},{default:a(()=>[t(d,{prop:"id",label:"id",align:"center"}),t(d,{prop:"classinfo",label:"班级",width:"150px",align:"center"}),t(d,{prop:"studentName",label:"姓名",align:"center"}),t(d,{prop:"studentNo",label:"学号",align:"center",width:"120px"}),t(d,{prop:"depart",label:"部门",align:"center"}),t(d,{prop:"school",label:"学校","show-overflow-tooltip":"",align:"center",width:"200px"}),t(d,{prop:"major",label:"专业",align:"center"}),t(d,{width:"250px",label:"操作"},{default:a(({row:o})=>[t(i,{onClick:g=>e.editStudent(o),type:"primary"},{default:a(()=>[t(S,{style:{width:"1em",height:"1em","margin-right":"8px"}}),r("修改 ")]),_:2},1032,["onClick"]),t(i,{onClick:g=>e.deleteStudent(o.id),type:"danger"},{default:a(()=>[t(v,{style:{width:"1em",height:"1em","margin-right":"8px"}}),r("删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e.page.total>0?(h(),V(B,{key:0,background:"",layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,"current-page":e.page.current,onCurrentChange:e.currentchange},null,8,["page-size","total","current-page","onCurrentChange"])):T("",!0)])]),t(A,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":l[10]||(l[10]=o=>e.dialogFormVisible=o),title:"学生编辑"},{footer:a(()=>[c("span",oe,[t(i,{onClick:l[9]||(l[9]=o=>e.dialogFormVisible=!1)},{default:a(()=>[r("取消")]),_:1}),t(i,{type:"primary",onClick:e.save},{default:a(()=>[r(" 保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[t(_,{model:e.allinfos},{default:a(()=>[t(p,{label:"学号","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.studentNo,"onUpdate:modelValue":l[3]||(l[3]=o=>e.allinfos.studentNo=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(p,{label:"姓名","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.studentName,"onUpdate:modelValue":l[4]||(l[4]=o=>e.allinfos.studentName=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(p,{label:"班级","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.classinfo,"onUpdate:modelValue":l[5]||(l[5]=o=>e.allinfos.classinfo=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(p,{label:"部门","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.depart,"onUpdate:modelValue":l[6]||(l[6]=o=>e.allinfos.depart=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(p,{label:"学校","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.school,"onUpdate:modelValue":l[7]||(l[7]=o=>e.allinfos.school=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(p,{label:"专业","label-width":e.formLabelWidth},{default:a(()=>[t(u,{modelValue:e.allinfos.major,"onUpdate:modelValue":l[8]||(l[8]=o=>e.allinfos.major=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const me=F(ee,[["render",ae]]);export{me as default};
