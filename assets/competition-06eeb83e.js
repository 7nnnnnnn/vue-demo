import{_ as x,e as I,E as m,o as c,c as w,a as _,b as l,z as F,w as a,t as C,G as U,F as y,n as S,g as T,h as W,j as A,k as D,l as h,D as N,r as k,m as B,p as q,u as K,s as j,q as O}from"./index-74fb4b2e.js";/* empty css                        *//* empty css                 */import{a as g}from"./competition-c31de812.js";const G={data(){return{one:!0,two:!1,ids:"",levels:[{label:"国际级",value:"国际级"},{label:"国家级",value:"国家级"},{label:"省级",value:"省级"},{label:"市级",value:"市级"},{label:"校级",value:"校级"},{label:"院级",value:"院级"}],competitiones:[],competitionesqu:[],page:{total:0,current:1,schoolId:1,size:10},dialogFormVisible:!1,dialogVisible:!1,competition:{id:0,name:"",start:"",end:"",homePage:"",type:"",level:"",organizer:"",schoolId:""},formLabelWidth:80,currentPage:1,pageSize:6,searchText:"",apiList:[],schools:[]}},created(){this.school()},mounted(){this.getCompetitionPage(1)},computed:{paginatedData(){const i=(this.currentPage-1)*this.pageSize,e=i+this.pageSize;return this.filteredApiList.slice(i,e)},filteredApiList(){return this.searchText&&this.apiList?this.apiList.filter(i=>i.name==this.searchText):this.apiList},schoolIds(){return i=>{let e="",n=this.schools.filter(b=>b.id==i.schoolId)[0];return n&&(e=n.schoolName),e}}},methods:{async school(){let{data:i}=await g.school();this.schools=i.schools},handlePageChange(i){this.currentPage=i},clearSearch(){this.searchText=""},toEdit(i){console.log(i),this.dialogFormVisible=!0,this.competition=I(i)},getCompetitionPage(i){const e={current:i,schoolId:1,size:10};g.competitionAll(e).then(n=>{console.log(n),this.apiList=n.data.competitions}).catch(n=>{console.log(n)})},currentchange(i){this.getCompetitionPage(i),this.page.current=i},del(i){console.log(i);const e={id:i};g.competitionDelId(e).then(n=>{if(n.success)this.getCompetitionPage(this.page.current),m.success("操作成功");else return console.log(n.msg),!1}).catch(n=>{})},toAdd(){this.dialogFormVisible=!0,this.competition={id:0,name:"",start:"",end:"",homePage:"",type:"",level:"",organizer:"",schoolId:""}},souos(i){console.log(i);const e={id:i};g.competitionOne(e).then(n=>{if(n.success){console.log(n);const b=n.data.competition;this.competitionesqu=b.competition,this.one=!1,this.two=!0}else console.log(n.msg),m("没有这个编号"),this.one=!0,this.two=!1}).catch(n=>{m("没有这个编号")})},save(){const i=this.competition;i.id==0?g.competitionAdd(i).then(e=>{if(e.success)this.dialogFormVisible=!1,this.getCompetitionPage(this.page.current),m.success(e.msg);else return m(e.msg),!1}).catch(e=>{m("网络错误联系管理员")}):g.competitionEdit(i).then(e=>{if(e.success)this.dialogFormVisible=!1,this.getCompetitionPage(this.page.current),m.success(e.msg);else return m(e.msg),!1}).catch(e=>{m("网络错误联系管理员")})}}},M={class:"competitiones"},H={class:"dialog-footer"};function J(i,e,n,b,t,r){const p=S,d=T,s=B,L=W,P=A,u=q,V=K,v=j,z=O,E=D;return c(),w(y,null,[_("div",null,[l(p,{modelValue:t.searchText,"onUpdate:modelValue":e[0]||(e[0]=o=>t.searchText=o),placeholder:"请输入搜索关键字",clearable:"",onClear:r.clearSearch,onKeyup:F(i.performSearch,["enter"]),style:{width:"300px"}},null,8,["modelValue","onClear","onKeyup"]),l(d,{type:"primary",onClick:r.toAdd},{default:a(()=>[h("添加")]),_:1},8,["onClick"]),l(d,{style:{float:"right","margin-right":"50px"},type:"primary",onClick:e[1]||(e[1]=o=>i.$router.go(-1))},{default:a(()=>[h("返回")]),_:1})]),_("div",M,[t.one?(c(),C(L,{key:0,data:r.paginatedData,style:{width:"100%"}},{default:a(()=>[l(s,{fixed:"",prop:"id",label:"序号"}),l(s,{prop:"name",label:"竞赛名称"}),l(s,{prop:"homePage",label:"竞赛官网"}),l(s,{prop:"type",label:"竞赛类型"}),l(s,{prop:"level",label:"竞赛等级"}),l(s,{prop:"schoolId",label:"学校名称"},{default:a(({row:o})=>[_("span",null,N(r.schoolIds(o)),1)]),_:1}),l(s,{prop:"organizer",label:"主办单位"}),l(s,{prop:"start",label:"开始时间"}),l(s,{prop:"end",label:"结束时间"}),l(s,{fixed:"right",label:"操作",width:"120"},{default:a(o=>[l(d,{link:"",type:"primary",size:"small",onClick:f=>r.toEdit(o.row)},{default:a(()=>[h("编辑")]),_:2},1032,["onClick"]),l(d,{link:"",type:"primary",size:"small",onClick:f=>r.del(o.row.id)},{default:a(()=>[h(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):U("",!0),l(P,{"current-page":t.currentPage,"page-size":t.pageSize,total:r.filteredApiList.length,onCurrentChange:r.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])]),l(E,{modelValue:t.dialogFormVisible,"onUpdate:modelValue":e[11]||(e[11]=o=>t.dialogFormVisible=o),title:"竞赛编辑"},{footer:a(()=>[_("span",H,[l(d,{onClick:e[10]||(e[10]=o=>t.dialogFormVisible=!1)},{default:a(()=>[h("取消")]),_:1}),l(d,{type:"primary",onClick:r.save},{default:a(()=>[h(" 保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[l(z,{model:t.competition},{default:a(()=>[l(u,{label:"竞赛名称","label-width":t.formLabelWidth},{default:a(()=>[l(p,{modelValue:t.competition.name,"onUpdate:modelValue":e[2]||(e[2]=o=>t.competition.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"竞赛官网","label-width":t.formLabelWidth},{default:a(()=>[l(p,{modelValue:t.competition.homePage,"onUpdate:modelValue":e[3]||(e[3]=o=>t.competition.homePage=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"竞赛类型","label-width":t.formLabelWidth},{default:a(()=>[l(v,{modelValue:t.competition.type,"onUpdate:modelValue":e[4]||(e[4]=o=>t.competition.type=o)},{default:a(()=>[l(V,{label:"个人赛",value:"个人赛"}),l(V,{label:"团体赛",value:"团体赛"})]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"竞赛等级","label-width":t.formLabelWidth},{default:a(()=>[l(v,{modelValue:t.competition.level,"onUpdate:modelValue":e[5]||(e[5]=o=>t.competition.level=o)},{default:a(()=>[(c(!0),w(y,null,k(t.levels,(o,f)=>(c(),C(V,{key:f,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"学校","label-width":t.formLabelWidth},{default:a(()=>[l(v,{modelValue:t.competition.schoolId,"onUpdate:modelValue":e[6]||(e[6]=o=>t.competition.schoolId=o)},{default:a(()=>[(c(!0),w(y,null,k(t.schools,(o,f)=>(c(),C(V,{key:f,label:o.schoolName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"主办单位","label-width":t.formLabelWidth},{default:a(()=>[l(p,{modelValue:t.competition.organizer,"onUpdate:modelValue":e[7]||(e[7]=o=>t.competition.organizer=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"开始时间","label-width":t.formLabelWidth},{default:a(()=>[l(p,{modelValue:t.competition.start,"onUpdate:modelValue":e[8]||(e[8]=o=>t.competition.start=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"结束时间","label-width":t.formLabelWidth},{default:a(()=>[l(p,{modelValue:t.competition.end,"onUpdate:modelValue":e[9]||(e[9]=o=>t.competition.end=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const Z=x(G,[["render",J]]);export{Z as default};
