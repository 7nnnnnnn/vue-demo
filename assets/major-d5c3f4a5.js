import{v as F,i as P,x as B,_ as z,E as m,y as U,o as f,c as I,a as g,b as t,w as o,z as M,F as V,g as q,n as K,h as O,j as J,k as G,l as _,D as k,r as w,A as W,m as H,p as Q,s as R,q as X,t as E,u as Y}from"./index-74fb4b2e.js";/* empty css                        *//* empty css                 */const Z=F(),$=Z.token,n={Authorization:"Bearer "+$};let C;const ee=()=>{C=B.service({lock:!0,text:"加载中..."})},te=()=>{C&&C.close()},i=async e=>{ee();try{return await P.request(e)}finally{te()}},ae=async e=>await i({url:"/api/school/all",method:"get",headers:n,data:e}),le=async e=>await i({url:"/api/department/all",method:"get",headers:n,data:e}),oe=async e=>await i({url:"/api/major/all",method:"get",headers:n,data:e}),re=async e=>await i({url:"/api/major/add",method:"post",headers:n,data:e}),se=async e=>await i({url:"/api/major/edit",method:"post",headers:n,data:e}),ne=async e=>await i({url:`/api/major/getMajorsForSelectBySchoolId?schoolId=${e.schoolId}`,method:"get",headers:n}),ie=async e=>await i({url:`/api/major/delete?id=${e.id}`,method:"get",headers:n}),u={school:ae,department:le,majorAdd:re,getMajor:oe,majorEdit:se,majorDelete:ie,getMajorsForSelectBySchoolId:ne};const de={created(){this.init(),this.school(),this.department()},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize,a=e+this.pageSize;return console.log(this.apiList),this.filteredApiList.slice(e,a)},filteredApiList(){return this.searchText&&this.apiList?this.apiList.filter(e=>e.majorName==this.searchText):this.apiList},schoolIds(){return e=>{let a="",d=this.schools.filter(y=>y.id==e.schoolId)[0];return d&&(a=d.schoolName),a}},departIds(){return e=>{let a="",d=this.departments.filter(y=>y.id==e.departId)[0];return d&&(a=d.departName),a}}},data(){return{title:"新增",editDialogVisible:!1,currentPage:1,pageSize:10,searchText:"",apiList:[],form:{createTime:"",deleted:0,departId:"",id:"",majorDesc:"",majorName:"",schoolId:"",updateTime:""},schools:[],departments:[],tableDepartments:[]}},methods:{handlePageChange(e){this.currentPage=e},async init(){let{data:e}=await u.getMajor();this.apiList=e.majors},async school(){let{data:e}=await u.school();this.schools=e.schools},async department(){let{data:e}=await u.department();this.departments=e.departments},addAPI(){this.title="新增",this.clearForm(),this.editDialogVisible=!0},editedAPI(e){this.title="编辑",this.form=JSON.parse(JSON.stringify(e)),this.editDialogVisible=!0},async Save(){if(this.form.id){let e=await u.majorEdit(this.form);e.code==1?(m.success("操作成功！"),this.clearForm(),this.editDialogVisible=!1):m.error(e.msg)}else{let e=await u.majorAdd(this.form);e.code==1?(m.success("操作成功！"),this.clearForm(),this.editDialogVisible=!1):m.error(e.msg)}this.init()},async majorDelete(e){let a=await u.majorDelete({id:e.id});a.code==1?(m.success("操作成功！"),this.init()):m.error(a.msg)},clearForm(){this.form={createTime:"",deleted:0,departId:"",id:"",majorDesc:"",majorName:"",schoolId:"",updateTime:""}}}},ce={class:"dialog-footer"};function me(e,a,d,y,r,s){const v=U("Search"),N=W,c=q,b=K,p=H,L=O,x=J,j=Q,D=Y,S=R,T=X,A=G;return f(),I(V,null,[g("div",null,[t(b,{modelValue:r.searchText,"onUpdate:modelValue":a[1]||(a[1]=l=>r.searchText=l),placeholder:"请输入搜索关键字",clearable:"",onClear:e.clearSearch,onKeyup:M(e.performSearch,["enter"]),style:{width:"300px"}},{append:o(()=>[t(c,{circle:"",type:"danger",onClick:a[0]||(a[0]=l=>e.Getone(this.searchText))},{default:o(()=>[t(N,null,{default:o(()=>[t(v)]),_:1})]),_:1})]),_:1},8,["modelValue","onClear","onKeyup"]),t(c,{type:"primary",onClick:s.addAPI},{default:o(()=>[_(" 新增 ")]),_:1},8,["onClick"])]),g("div",null,[t(L,{data:s.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"}},{default:o(()=>[t(p,{prop:"majorName",label:"专业名称"}),t(p,{prop:"majorDesc",label:"专业描述"}),t(p,{prop:"schoolId",label:"学校名称"},{default:o(({row:l})=>[g("span",null,k(s.schoolIds(l)),1)]),_:1}),t(p,{prop:"departId",label:"学院名称"},{default:o(({row:l})=>[g("span",null,k(s.departIds(l)),1)]),_:1}),t(p,{label:"操作","min-width":"100px"},{default:o(({row:l})=>[t(c,{type:"primary",onClick:h=>s.editedAPI(l)},{default:o(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),t(c,{type:"primary",onClick:h=>s.majorDelete(l)},{default:o(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(x,{"current-page":r.currentPage,"page-size":r.pageSize,total:s.filteredApiList.length,onCurrentChange:s.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),t(A,{modelValue:r.editDialogVisible,"onUpdate:modelValue":a[6]||(a[6]=l=>r.editDialogVisible=l),title:r.title,center:"",width:"50%"},{footer:o(()=>[g("span",ce,[t(c,{onClick:e.Cancel},{default:o(()=>[_("取消")]),_:1},8,["onClick"]),t(c,{type:"primary",onClick:s.Save},{default:o(()=>[_(" 保存 ")]),_:1},8,["onClick"])])]),default:o(()=>[t(T,{model:r.form},{default:o(()=>[t(j,{label:"专业名称"},{default:o(()=>[t(b,{modelValue:r.form.majorName,"onUpdate:modelValue":a[2]||(a[2]=l=>r.form.majorName=l)},null,8,["modelValue"])]),_:1}),t(j,{label:"专业描述"},{default:o(()=>[t(b,{modelValue:r.form.majorDesc,"onUpdate:modelValue":a[3]||(a[3]=l=>r.form.majorDesc=l)},null,8,["modelValue"])]),_:1}),t(j,{label:"学校名称"},{default:o(()=>[t(S,{modelValue:r.form.schoolId,"onUpdate:modelValue":a[4]||(a[4]=l=>r.form.schoolId=l),onChange:e.getMajorsForSelectBySchoolId},{default:o(()=>[(f(!0),I(V,null,w(r.schools,(l,h)=>(f(),E(D,{key:h,label:l.schoolName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),t(j,{label:"学院名称"},{default:o(()=>[t(S,{modelValue:r.form.departId,"onUpdate:modelValue":a[5]||(a[5]=l=>r.form.departId=l)},{default:o(()=>[(f(!0),I(V,null,w(r.departments,(l,h)=>(f(),E(D,{key:h,label:l.departName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])],64)}const fe=z(de,[["render",me]]);export{fe as default};
