import{v as z,i as N,x as F,_ as G,E as r,f as C,y as g,o as f,c as R,a as h,b as e,w as i,z as q,F as K,g as M,n as O,h as j,j as W,k as H,t as V,l as D,A as J,m as Q,p as X,q as Y}from"./index-74fb4b2e.js";/* empty css                        *//* empty css                 */const Z=z(),$=Z.token,A={Authorization:"Bearer "+$};let b;const ee=()=>{b=F.service({lock:!0,text:"加载中..."})},le=()=>{b&&b.close()},I=async t=>{ee();try{return await N.request(t)}finally{le()}},te=async t=>await I({url:"/api/menu-rule/add",method:"post",headers:A,data:t}),ne=async t=>await I({url:"/api/menu-rule/edit",method:"post",headers:A,data:t}),oe=async t=>await I({url:"/api/menu-rule/one?id="+t,method:"get",headers:A}),ie=async t=>await I({url:"/api/menu-rule/page",method:"post",headers:A,data:t}),ae=async t=>await I({url:"/api/menu-rule/del?id="+t,method:"get",headers:A}),_={addData:te,editData:ne,delData:ae,getOneData:oe,getPageData:ie};const de={created(){this.GetAll()},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,l=t+this.pageSize;return this.filteredApiList.slice(t,l)},filteredApiList(){return this.searchText&&this.apiList?this.apiList.filter(t=>t.id==this.searchText):this.apiList}},data(){return{editedAPI:{},editDialogVisible:!1,currentPage:1,pageSize:6,searchText:"",apiList:[]}},methods:{handlePageChange(t){this.currentPage=t},clearSearch(){this.searchText=""},Cancel(){this.editDialogVisible=!1,r.info("保存取消！")},Getone(t){this.apiList=[],_.getOneData(t).then(l=>{console.log("搜索成功！"),r.success("搜索成功！");const m=l.data.backendApi;this.apiList.push(m)}).catch(l=>{r.error("搜索失败！"),console.log("搜索失败！")})},Save(){console.log("Saving API:",this.editedAPI);const t=this.apiList.findIndex(l=>l.id===this.editedAPI.id);t!==-1?this.apiList.splice(t,1,this.editedAPI):this.apiList.push(this.editedAPI),this.editDialogVisible=!1,r.success("保存成功！")},openEditDialog(t){this.editedAPI={...t},this.editDialogVisible=!0},editAPI(t){console.log("编辑 API",t)},deleteAPI(t){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.delData(t.id).then(l=>{if(l.success){const m=this.apiList.findIndex(y=>y.id===t.id);m!==-1&&this.apiList.splice(m,1),console.log("删除成功"),r.success("删除成功！")}else r.error(l.msg),console.error(l.msg)}).catch(l=>{console.error(l)}),console.log("删除 API")}).catch(l=>{console.log("不删除 API",l)})},deleteData(t){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=this.apiList.findIndex(m=>m.id===t.id);l!==-1&&this.apiList.splice(l,1),r.success("删除成功！")}).catch(()=>{r.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){r.success("添加数据ing");const t={component:"",createTime:"",extend:"",icon:"",id:0,keepalive:0,menuType:"",name:"",path:"",pid:0,remark:"",status:"",title:"",type:"",updateTime:"",url:"",weigh:0,isNew:!0};this.apiList.push(t)},async GetAll(){try{this.clearSearch();const t=await _.getAllData();if(t.success){const l=t.data.backendApis;this.apiList=l,r.success("刷新成功！")}else r.error("请求失败！"),console.error(t.msg)}catch(t){console.error(t)}},Insert(t){_.addData(t).then(l=>{delete t.isNew,r.success("添加成功！"),console.log("添加成功！")}).catch(l=>{r.error("添加失败！"),console.log("添加失败！")})},Alter(t){_.editData(t).then(l=>{console.log("修改成功！"),r.success("修改成功！")}).catch(l=>{console.log("修改失败！"),r.error("修改失败！")})}}},se={class:"dialog-footer"};function re(t,l,m,y,o,u){const L=g("Search"),c=J,p=M,a=O,d=Q,k=g("Position"),v=g("EditPen"),x=g("Delete"),U=j,E=W,w=g("CirclePlusFilled"),T=g("RefreshRight"),s=X,S=Y,B=H;return f(),R(K,null,[h("div",null,[e(a,{modelValue:o.searchText,"onUpdate:modelValue":l[1]||(l[1]=n=>o.searchText=n),placeholder:"请输入搜索关键字",clearable:"",onClear:u.clearSearch,onKeyup:q(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},{append:i(()=>[e(p,{circle:"",type:"danger",onClick:l[0]||(l[0]=n=>u.Getone(this.searchText))},{default:i(()=>[e(c,null,{default:i(()=>[e(L)]),_:1})]),_:1})]),_:1},8,["modelValue","onClear","onKeyup"])]),h("div",null,[e(U,{data:u.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},border:""},{default:i(()=>[e(d,{prop:"id",label:"ID"}),e(d,{prop:"pid",label:"上级菜单"}),e(d,{prop:"type",label:"类型:menu_dir=菜单目录,menu=菜单项,button=页面按钮"}),e(d,{prop:"title",label:"标题"}),e(d,{prop:"name",label:"规则名称"}),e(d,{prop:"path",label:"路由路径"}),e(d,{prop:"icon",label:"图标"}),e(d,{prop:"menu_type",label:"菜单类型:tab=选项卡,link=链接,iframe=Iframe"}),e(d,{prop:"url",label:"Url"}),e(d,{prop:"component",label:"组件路径"}),e(d,{prop:"keepalive",label:"缓存:0=关闭,1=开启"}),e(d,{prop:"extend",label:"扩展属性:none=无,add_rules_only=只添加为路由,add_menu_only=只添加为菜单"}),e(d,{prop:"remark",label:"备注"}),e(d,{prop:"weigh",label:"权重(排序)"}),e(d,{prop:"status",label:"状态:0=禁用,1=启用"}),e(d,{prop:"updatetime",label:"更新时间"}),e(d,{prop:"createtime",label:"创建时间"}),e(d,{label:"操作"},{default:i(({row:n})=>[n.isNew?(f(),V(p,{key:0,class:"custom-button",type:"success",circle:"",onClick:P=>u.Insert(n)},{default:i(()=>[e(c,null,{default:i(()=>[e(k)]),_:1})]),_:2},1032,["onClick"])):(f(),V(p,{key:1,class:"custom-button",type:"warning",circle:"",onClick:P=>u.Alter(n)},{default:i(()=>[e(c,null,{default:i(()=>[e(k)]),_:1})]),_:2},1032,["onClick"])),e(p,{type:"primary",circle:"",onClick:P=>u.openEditDialog(n)},{default:i(()=>[e(c,null,{default:i(()=>[e(v)]),_:1})]),_:2},1032,["onClick"]),n.isNew?(f(),V(p,{key:2,type:"danger",circle:"",onClick:P=>u.deleteData(n)},{default:i(()=>[e(c,null,{default:i(()=>[e(x)]),_:1})]),_:2},1032,["onClick"])):(f(),V(p,{key:3,type:"danger",circle:"",onClick:P=>u.deleteAPI(n)},{default:i(()=>[e(c,null,{default:i(()=>[e(x)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),e(E,{"current-page":o.currentPage,"page-size":o.pageSize,total:u.filteredApiList.length,onCurrentChange:u.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),e(p,{type:"primary",circle:"",onClick:u.addAPI,style:{"margin-top":"10px"}},{default:i(()=>[e(c,null,{default:i(()=>[e(w)]),_:1})]),_:1},8,["onClick"]),e(p,{type:"primary",circle:"",onClick:u.GetAll,style:{"margin-top":"10px"}},{default:i(()=>[e(c,null,{default:i(()=>[e(T)]),_:1})]),_:1},8,["onClick"]),e(B,{modelValue:o.editDialogVisible,"onUpdate:modelValue":l[19]||(l[19]=n=>o.editDialogVisible=n),title:"编辑内容",center:"",width:"50%"},{footer:i(()=>[h("span",se,[e(p,{onClick:u.Cancel},{default:i(()=>[D("取消")]),_:1},8,["onClick"]),e(p,{type:"primary",onClick:u.Save},{default:i(()=>[D(" 保存 ")]),_:1},8,["onClick"])])]),default:i(()=>[e(S,{model:o.editedAPI,"label-width":"100px"},{default:i(()=>[e(s,{label:"id"},{default:i(()=>[e(a,{modelValue:o.editedAPI.ID,"onUpdate:modelValue":l[2]||(l[2]=n=>o.editedAPI.ID=n),disabled:""},null,8,["modelValue"])]),_:1}),e(s,{label:"pid"},{default:i(()=>[e(a,{modelValue:o.editedAPI.pid,"onUpdate:modelValue":l[3]||(l[3]=n=>o.editedAPI.pid=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"type"},{default:i(()=>[e(a,{modelValue:o.editedAPI.type,"onUpdate:modelValue":l[4]||(l[4]=n=>o.editedAPI.type=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"title"},{default:i(()=>[e(a,{modelValue:o.editedAPI.title,"onUpdate:modelValue":l[5]||(l[5]=n=>o.editedAPI.title=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"name"},{default:i(()=>[e(a,{modelValue:o.editedAPI.name,"onUpdate:modelValue":l[6]||(l[6]=n=>o.editedAPI.name=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"path"},{default:i(()=>[e(a,{modelValue:o.editedAPI.path,"onUpdate:modelValue":l[7]||(l[7]=n=>o.editedAPI.path=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"icon"},{default:i(()=>[e(a,{modelValue:o.editedAPI.icon,"onUpdate:modelValue":l[8]||(l[8]=n=>o.editedAPI.icon=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"menu_type"},{default:i(()=>[e(a,{modelValue:o.editedAPI.menu_type,"onUpdate:modelValue":l[9]||(l[9]=n=>o.editedAPI.menu_type=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"url"},{default:i(()=>[e(a,{modelValue:o.editedAPI.url,"onUpdate:modelValue":l[10]||(l[10]=n=>o.editedAPI.url=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"component"},{default:i(()=>[e(a,{modelValue:o.editedAPI.component,"onUpdate:modelValue":l[11]||(l[11]=n=>o.editedAPI.component=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"keepalive"},{default:i(()=>[e(a,{modelValue:o.editedAPI.keepalive,"onUpdate:modelValue":l[12]||(l[12]=n=>o.editedAPI.keepalive=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"extend"},{default:i(()=>[e(a,{modelValue:o.editedAPI.extend,"onUpdate:modelValue":l[13]||(l[13]=n=>o.editedAPI.extend=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"remark"},{default:i(()=>[e(a,{modelValue:o.editedAPI.remark,"onUpdate:modelValue":l[14]||(l[14]=n=>o.editedAPI.remark=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"weigh"},{default:i(()=>[e(a,{modelValue:o.editedAPI.weigh,"onUpdate:modelValue":l[15]||(l[15]=n=>o.editedAPI.weigh=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"status"},{default:i(()=>[e(a,{modelValue:o.editedAPI.status,"onUpdate:modelValue":l[16]||(l[16]=n=>o.editedAPI.status=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"updatetime"},{default:i(()=>[e(a,{modelValue:o.editedAPI.updatetime,"onUpdate:modelValue":l[17]||(l[17]=n=>o.editedAPI.updatetime=n)},null,8,["modelValue"])]),_:1}),e(s,{label:"createtime"},{default:i(()=>[e(a,{modelValue:o.editedAPI.createtime,"onUpdate:modelValue":l[18]||(l[18]=n=>o.editedAPI.createtime=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])],64)}const me=G(de,[["render",re]]);export{me as default};
