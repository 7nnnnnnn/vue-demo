import{_ as P,e as S,E as p,o as c,c as b,a as h,b as l,z,w as i,t as _,G as F,F as V,n as L,g as T,h as A,j as D,k as B,l as g,D as q,r as v,m as O,s as U,p as j,q as K,u as W}from"./index-1c8d0cbc.js";/* empty css                        *//* empty css                 */import{a as f}from"./competition-80636ff1.js";import{g as J}from"./student-d2be19c8.js";const G={data(){return{one:!0,two:!1,ids:"",levels:[{label:"国际级",value:"国际级"},{label:"国家级",value:"国家级"},{label:"省级",value:"省级"},{label:"市级",value:"市级"},{label:"校级",value:"校级"},{label:"院级",value:"院级"}],competitiones:[],competitionesqu:[],page:{total:0,current:1,schoolId:1,size:10},dialogFormVisible:!1,dialogVisible:!1,competition:{studentName:"",schoolName:""},formLabelWidth:110,currentPage:1,pageSize:6,searchText:"",apiList:[],schools:[],all:[],row:{},student:[]}},created(){this.getCompetitionPage(1),this.getAll(),this.school()},mounted(){},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filteredApiList.slice(e,t)},filteredApiList(){return this.searchText&&this.apiList?this.apiList.filter(e=>e.name==this.searchText):this.apiList},schoolIds(){return e=>{let t="",o=this.schools.filter(m=>m.id==e.schoolId)[0];return o&&(t=o.schoolName),t}}},methods:{application(e){this.row=e,this.dialogFormVisible=!0},getAll(){J().then(e=>{console.log(e),this.all=e.data.students}).catch(e=>{console.log(e)})},async school(){let{data:e}=await f.school();this.schools=e.schools},handlePageChange(e){this.currentPage=e},clearSearch(){this.searchText=""},toEdit(e){console.log(e),this.dialogFormVisible=!0,this.competition=S(e)},getCompetitionPage(e){const t={current:e,schoolId:1,size:10};f.competitionAll(t).then(o=>{console.log(o),this.apiList=o.data.competitions}).catch(o=>{console.log(o)})},currentchange(e){this.getCompetitionPage(e),this.page.current=e},del(e){console.log(e);const t={id:e};f.competitionDelId(t).then(o=>{if(o.success)this.getCompetitionPage(this.page.current),p.success("操作成功");else return console.log(o.msg),!1}).catch(o=>{})},toAdd(){this.dialogFormVisible=!0,this.competition={id:0,name:"",start:"",end:"",homePage:"",type:"",level:"",organizer:"",schoolId:""}},souos(e){console.log(e);const t={id:e};f.competitionOne(t).then(o=>{if(o.success){console.log(o);const m=o.data.competition;this.competitionesqu=m.competition,this.one=!1,this.two=!0}else console.log(o.msg),p("没有这个编号"),this.one=!0,this.two=!1}).catch(o=>{p("没有这个编号")})},save(){let e=localStorage.getItem("student"),t=!1;if(e&&JSON.parse(e).forEach(o=>{o.name==this.competition.studentName&&(t=!0)}),t)return p("不能重复报名");this.student.push({name:this.competition.studentName,title:this.row.name,schoolName:this.competition.schoolName,status:"待审核"}),localStorage.setItem("student",JSON.stringify(this.student)),p.success("报名成功，等待审核"),this.dialogFormVisible=!1}}},M={style:{display:"flex","justify-content":"space-between"}},H={class:"competitiones"},Q={class:"dialog-footer"};function R(e,t,o,m,s,r){const w=L,u=T,n=O,x=A,E=D,y=W,C=U,N=j,k=K,I=B;return c(),b(V,null,[h("div",M,[l(w,{modelValue:s.searchText,"onUpdate:modelValue":t[0]||(t[0]=a=>s.searchText=a),placeholder:"请输入搜索关键字",clearable:"",onClear:r.clearSearch,onKeyup:z(e.performSearch,["enter"]),style:{width:"300px"}},null,8,["modelValue","onClear","onKeyup"]),l(u,{style:{"margin-right":"50px"},type:"primary",onClick:t[1]||(t[1]=a=>e.$router.go(-1))},{default:i(()=>[g("返回")]),_:1})]),h("div",H,[s.one?(c(),_(x,{key:0,data:r.paginatedData,style:{width:"100%"}},{default:i(()=>[l(n,{fixed:"",prop:"id",label:"序号"}),l(n,{prop:"name",label:"竞赛名称"}),l(n,{prop:"homePage",label:"竞赛官网"}),l(n,{prop:"type",label:"竞赛类型"}),l(n,{prop:"level",label:"竞赛等级"}),l(n,{prop:"schoolId",label:"学校名称"},{default:i(({row:a})=>[h("span",null,q(r.schoolIds(a)),1)]),_:1}),l(n,{prop:"organizer",label:"主办单位"}),l(n,{prop:"start",label:"开始时间"}),l(n,{prop:"end",label:"结束时间"}),l(n,{fixed:"right",label:"操作",width:"120"},{default:i(a=>[l(u,{link:"",type:"primary",size:"small",onClick:d=>r.application(a.row)},{default:i(()=>[g("报名")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])):F("",!0),l(E,{"current-page":s.currentPage,"page-size":s.pageSize,total:r.filteredApiList.length,onCurrentChange:r.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])]),l(I,{modelValue:s.dialogFormVisible,"onUpdate:modelValue":t[5]||(t[5]=a=>s.dialogFormVisible=a),title:"报名信息"},{footer:i(()=>[h("span",Q,[l(u,{onClick:t[4]||(t[4]=a=>s.dialogFormVisible=!1)},{default:i(()=>[g("取消")]),_:1}),l(u,{type:"primary",onClick:r.save},{default:i(()=>[g(" 保存 ")]),_:1},8,["onClick"])])]),default:i(()=>[l(k,{model:s.competition},{default:i(()=>[l(N,{label:"竞赛负责人","label-width":s.formLabelWidth},{default:i(()=>[l(C,{modelValue:s.competition.studentName,"onUpdate:modelValue":t[2]||(t[2]=a=>s.competition.studentName=a)},{default:i(()=>[(c(!0),b(V,null,v(s.all,(a,d)=>(c(),_(y,{key:d,label:a.studentName,value:a.studentName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),l(N,{label:"学校","label-width":s.formLabelWidth},{default:i(()=>[l(C,{modelValue:s.competition.schoolName,"onUpdate:modelValue":t[3]||(t[3]=a=>s.competition.schoolName=a)},{default:i(()=>[(c(!0),b(V,null,v(s.schools,(a,d)=>(c(),_(y,{key:d,label:a.schoolName,value:a.schoolName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const te=P(G,[["render",R]]);export{te as default};
